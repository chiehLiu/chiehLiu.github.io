<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="author" content="Chieh Liu"><title>JS實作練習-Javascript 30 01 - JavaScript Drum Kit | Chieh Liu&#39;s Blog</title><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"><script src="/js/script.js"></script><script src="/js/tocbot.min.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Chieh Liu's Blog" type="application/atom+xml">
</head><body><div class="wrapper"><header><nav class="navbar"><div class="container"><div class="navbar-header header-logo"><a href="/">Chieh Liu&#39;s Blog</a></div><div class="menu navbar-right"><a class="menu-item" href="/archives">Posts</a> <a class="menu-item" href="/category">Categories</a> <a class="menu-item" href="/tag">Tags</a> <a class="menu-item" href="/about">About</a> <input id="switch_default" type="checkbox" class="switch_default"> <label for="switch_default" class="toggleBtn"></label></div></div></nav><nav class="navbar-mobile" id="nav-mobile"><div class="container"><div class="navbar-header"><div><a href="/">Chieh Liu&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a></div><div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div></div><div class="menu" id="mobile-menu"><a class="menu-item" href="/archives">Posts</a> <a class="menu-item" href="/category">Categories</a> <a class="menu-item" href="/tag">Tags</a> <a class="menu-item" href="/about">About</a></div></div></nav></header><script>var mobileBtn=function(){var e=document.getElementsByClassName("menu-toggle")[0],t=document.getElementById("mobile-menu");e.classList.contains("active")?(e.classList.remove("active"),t.classList.remove("active")):(e.classList.add("active"),t.classList.add("active"))}</script><div class="main"><div class="container"><div class="post-toc"><div class="tocbot-list"></div><div class="tocbot-list-menu"><a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a> <a onclick="go_top()">Back to top</a> <a onclick="go_bottom()">Go to bottom</a></div></div><script>function expand_toc(){var o=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:6,orderedList:!1,scrollSmooth:!0}),o.setAttribute("onclick","collapse_toc()"),o.innerHTML="Collapse all"}function collapse_toc(){var o=document.querySelector(".tocbot-toc-expand");tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0}),o.setAttribute("onclick","expand_toc()"),o.innerHTML="Expand all"}function go_top(){window.scrollTo(0,0)}function go_bottom(){window.scrollTo(0,document.body.scrollHeight)}document.ready((function(){tocbot.init({tocSelector:".tocbot-list",contentSelector:".post-content",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:1,orderedList:!1,scrollSmooth:!0})}))</script><article class="post-wrap"><header class="post-header"><h1 class="post-title">JS實作練習-Javascript 30 01 - JavaScript Drum Kit</h1><div class="post-meta">Author: <a itemprop="author" rel="author" href="/">Chieh Liu</a> <span class="post-time">Date: <a href="#">November 14, 2020&nbsp;&nbsp;20:27:12</a> </span><span class="post-category">Category: <a href="/categories/Javascript%E4%BD%9C%E5%93%81/">Javascript作品</a></span></div></header><div class="post-content"><h1 id="Javascript-30-01-JavaScript-Drum-Kit"><a href="#Javascript-30-01-JavaScript-Drum-Kit" class="headerlink" title="Javascript 30 01 - JavaScript Drum Kit"></a>Javascript 30 01 - JavaScript Drum Kit</h1><hr><h2 id="tags-Javascript-relate"><a href="#tags-Javascript-relate" class="headerlink" title="tags: Javascript relate"></a>tags: Javascript relate</h2><h6 id="tags-Javascript"><a href="#tags-Javascript" class="headerlink" title="tags: Javascript"></a>tags: <code>Javascript</code></h6><p>跟著做 JS 30 第一個作品 Drum kit</p><p>主要是用這個頁面呈現，搭配鍵盤上面的按鈕做出可以有聲音互動的頁面</p><p><a target="_blank" rel="noopener" href="https://chiehliu.github.io/git-projects/01%20-%20JavaScript%20Drum%20Kit/index-START.html">跟著做出來的範例</a></p><p><img src="https://i.imgur.com/vu8a03l.png"></p><h2 id="想法示意圖"><a href="#想法示意圖" class="headerlink" title="想法示意圖"></a>想法示意圖</h2><p>一開始從 KB 取得 keycode，接下來就可以連結到兩個部分:</p><ul><li>音效 music: 按下去時候的鼓聲</li><li>DOM style: 按下去時候的變大特效</li></ul><p>然後從特效這邊會延伸出去一些東西:</p><ul><li>add class: 放大的黃圈特效</li><li>transform: add class 之後他會做這個動畫變形</li><li>transition: 這個跟 transform 是連動的</li><li>remove class: 移除後恢復按下去之前的樣子</li></ul><p><img src="https://i.imgur.com/AeYB2i6.png"></p><h2 id="完整程式碼"><a href="#完整程式碼" class="headerlink" title="完整程式碼"></a>完整程式碼</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  ;(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">playHandler</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">const</span> audio = <span class="built_in">document</span>.querySelector(<span class="string">`audio[data-key=&quot;<span class="subst">$&#123;e.keyCode&#125;</span>&quot;]`</span>);</span><br><span class="line">      <span class="keyword">if</span> (audio) &#123;</span><br><span class="line">        audio.currentTime = <span class="number">0</span>; <span class="comment">//連續觸發的關鍵</span></span><br><span class="line">        audio.play();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> dom = <span class="built_in">document</span>.querySelector(<span class="string">`div[data-key=&quot;<span class="subst">$&#123;e.keyCode&#125;</span>&quot;]`</span>); <span class="comment">// 這邊字串必須使用``這個裡面的符號才有意義</span></span><br><span class="line">      <span class="keyword">if</span> (dom) dom.classList.add(<span class="string">&#x27;playing&#x27;</span>); <span class="comment">//這邊的add是method</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">transitionendHandler</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(e);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (e.propertyName === <span class="string">&#x27;transform&#x27;</span>) &#123;</span><br><span class="line">        e.currentTarget.classList.remove(<span class="string">&#x27;playing&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&#x27;keydown&#x27;</span>, playHandler)</span><br><span class="line">    <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;.key&#x27;</span>).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">      key.addEventListener(<span class="string">&#x27;transitionend&#x27;</span>, transitionendHandler)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)()</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="keyboardEvent-裡面的值"><a href="#keyboardEvent-裡面的值" class="headerlink" title="keyboardEvent 裡面的值"></a>keyboardEvent 裡面的值</h2><p>印出來之後裡面會有很多 property，然後裡面有兩個比較重要的會是 key 跟 keycode</p><p><img src="https://i.imgur.com/UyTv5Y4.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;keydown&#x27;</span>, playHandler);</span><br><span class="line"><span class="comment">//這邊使用keydown是因為想讓他按著可以一直撥放</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">playHandler</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(e)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>下圖可以看到那些 keycode 可以放在 HTML 裡面待會讓 JS 去做對應</p><p><img src="https://i.imgur.com/nh5PLZi.png"></p><p><img src="https://i.imgur.com/jrXPz2T.png"></p><h2 id="Play-music"><a href="#Play-music" class="headerlink" title="Play music"></a>Play music</h2><p>這邊使用了 ES6 的 template string <code>(``)</code>所以她後面才會加${}並且裡面放的就是 keycode 讓他抓取到鍵盤按下去的物件，接下來設定 if 條件來讓他發出聲音</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">playHandler</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> audio = <span class="built_in">document</span>.querySelector(<span class="string">`audio[data-key=&quot;<span class="subst">$&#123;e.keyCode&#125;</span>&quot;]`</span>);</span><br><span class="line">    <span class="comment">//上方這段程式碼就已經找到鍵盤對應的audio區塊了</span></span><br><span class="line">    <span class="keyword">if</span> (audio) &#123;</span><br><span class="line">        <span class="comment">// 這邊使用if可以讓不是keycode範圍內的鍵盤不會跳出錯誤因為會直接跳出這個條件式避免太多出錯</span></span><br><span class="line">         audio.currentTime = <span class="number">0</span>; <span class="comment">//連續觸發的關鍵</span></span><br><span class="line">         audio.play();<span class="comment">// 這邊play也是方法還有個兄弟pause()</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="DOM-style"><a href="#DOM-style" class="headerlink" title="DOM style"></a>DOM style</h2><p>這樣一樣去抓取要跳出特效的 div 然後使用 if 條件去他去跑’playing’這個 class 而不是原來那個</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dom = <span class="built_in">document</span>.querySelector(<span class="string">`div[data-key=&quot;<span class="subst">$&#123;e.keyCode&#125;</span>&quot;]`</span>);</span><br><span class="line"><span class="comment">// 這邊因為要出現的是那個物件的特效所以選取的是div</span></span><br><span class="line">        <span class="keyword">if</span> (dom) dom.classList.add(<span class="string">&#x27;playing&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//這邊的add是method 通常會一起用的還有remove跟toggle</span></span><br></pre></td></tr></table></figure><p>上面那行程式碼只做了讓他放大且變黃的特效，接下來要來處理放開之後變回原狀(class 要收掉)</p><p><img src="https://i.imgur.com/u1uBXEA.png"></p><p><img src="https://i.imgur.com/QAWHIzq.png"></p><p>一開始先選取所有的.key 的部分加入監聽之後使用<code>transitionend</code>並加入函式<code>transitionendHandler</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;.key&#x27;</span>).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">key.addEventListener(<span class="string">&#x27;transitionend&#x27;</span>, transitionendHandler)</span><br><span class="line">        <span class="comment">// transitionend是事件event</span></span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">transitionendHandler</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (e.propertyName === <span class="string">&#x27;transform&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">//propertyName 這個是property</span></span><br><span class="line">          e.currentTarget.classList.remove(<span class="string">&#x27;playing&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>下方這些東西是當 transition 效果結束之後會回傳的內容，在這裡我們就拿 propertyName = transform 這個來當指標，當 transform 出來（也就是 transition 結束，transitionend 被觸發時），把 .playing 這個 class 移除。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可以用這串驗證一下</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">transitionendHandler</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/pMkgNqy.png"></p><h2 id="小補充"><a href="#小補充" class="headerlink" title="小補充"></a>小補充</h2><ul><li>data-* attribute 屬性:可自定義名稱</li><li>keycode:每個鍵盤按鍵都有對應的 keycode</li><li>es6 語法:箭頭函式、模板字串符(變數${})</li></ul></div><section class="post-copyright"></section><section class="post-tags"><div><span>Tag(s):</span> <span class="tag"><a href="/tags/HTML/"># HTML</a> <a href="/tags/CSS/"># CSS</a> <a href="/tags/JavaScript/"># JavaScript</a></span></div><div><a href="javascript:window.history.back();">back</a> <span>· </span><a href="/">home</a></div></section><section class="post-nav"><a class="prev" rel="prev" href="/2020/11/15/Javascript%2030%2002%20-%20CSS%20+%20JS%20Clock/">實作練習-Javascript 30 02 - CSS + JS Clock</a> <a class="next" rel="next" href="/2020/11/12/JS-for-beginner/">JS-幼幼班 - Javascript 篇(一萬字)</a></section></article></div></div><footer id="footer" class="footer"><div class="copyright"><span>© Chieh Liu | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span></div></footer></div></body></html>